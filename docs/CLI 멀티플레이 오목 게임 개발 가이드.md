# CLI 멀티플레이 오목 게임 개발 가이드

# 📋 프로젝트 개요

네트워크 기반 CLI 멀티플레이 오목 게임 (렌주룰 적용)

---

## 🎯 핵심 요구사항

### 1. 프로젝트 구조

```
omok-game/
├── server.py          # 서버 프로그램 (Python으로 실행)
├── client.py          # 클라이언트 프로그램 (exe 빌드 대상)
├── config.json        # 설정 파일
└── requirements.txt   # Python 라이브러리 목록

```

### 2. 기술 스택

- **언어**: Python 3.8+
- **외부 라이브러리**:
    - `rich` (터미널 UI 및 색상)
    - `keyboard` 또는 `pynput` (화살표 키 입력)
    - `PyInstaller` (exe 빌드용)
- **네트워크**: Python 표준 `socket` + `threading`

---

## 🎮 게임 사양

### 오목판

- **크기**: 15x15 (표준)
- **표시 방식**:
    - 간단한 텍스트 좌표 (A-O 열, 1-15 행)
    - 터미널 색상 적용 (흑돌, 백돌 구분)
    - 현재 커서 위치 하이라이트

### 게임 규칙

- **렌주룰** 적용:
    - 흑돌(선공): 3-3, 4-4, 6목 금지
    - 백돌(후공): 제약 없음
    - 정확히 5개 연속으로 승리
- **승리 조건**: 가로/세로/대각선 정확히 5개 연속

### 입력 방식

- **화살표 키**: 커서 이동 (↑↓←→)
- **Enter**: 현재 커서 위치에 착수
- **ESC**: 메뉴 열기 (기권, 무르기 요청 등)

### 시간 제한

- **한 수당 30초** (고정)
- 시간 초과 시 자동 패배

---

## 🌐 네트워크 구조

### 서버-클라이언트 모델

- **전용 서버**: 독립 실행되는 서버 프로그램
- **클라이언트**: 서버에 접속하는 플레이어 프로그램

### 방 시스템

- 플레이어가 방을 생성하거나 기존 방 목록에서 선택
- 각 방은 2명의 플레이어만 입장 가능
- 방 정보:
    - 방 이름
    - 방장 닉네임
    - 현재 인원 (1/2 또는 2/2)
    - 게임 상태 (대기 중, 진행 중)

### 사용자 인증

- **닉네임만 사용** (회원가입 불필요)
- 접속 시 닉네임 입력
- 중복 닉네임 허용 (서버가 내부적으로 식별자 부여)

---

## 🔧 주요 기능

### 게임 중 기능

1. **무르기 요청**
    - 플레이어가 무르기 요청
    - 상대방이 수락/거절
    - 수락 시 한 수 되돌리기
2. **기권/포기**
    - 게임 중 언제든지 포기 가능
    - 확인 메시지 후 즉시 패배 처리
3. **시간 표시**
    - 현재 플레이어의 남은 시간 실시간 표시
    - 10초 이하일 때 경고 색상

### UI 요소

- **게임 화면 구성**:
    
    ```
    ┌─────────────────────────────────┐│ 방 이름: 초보자의 방              ││ 흑돌(선공): Player1 ● | 남은 시간: 25초│ 백돌(후공): Player2 ○ | 남은 시간: 30초├─────────────────────────────────┤│    A B C D E F G H I J K L M N O││ 1  · · · · · · · · · · · · · · ·││ 2  · · · · · · · · · · · · · · ·││ 3  · · · ● · · · · · · · · · · ·││ 4  · · · · ○ · · · · · · · · · ·││ 5  · · · · · [·] · · · · · · · ·│ ← 커서│    ...                           ││15  · · · · · · · · · · · · · · ·│├─────────────────────────────────┤│ 당신의 차례입니다.                ││ ESC: 메뉴 열기                   │└─────────────────────────────────┘
    
    ```
    

---

## 📡 통신 프로토콜

### 메시지 형식

JSON 기반 메시지 교환

### 클라이언트 → 서버

```json
{
  "type": "create_room",
  "data": {
    "room_name": "초보자의 방",
    "nickname": "Player1"
  }
}

```

```json
{
  "type": "move",
  "data": {
    "x": 7,
    "y": 7
  }
}

```

```json
{
  "type": "undo_request"
}

```

### 서버 → 클라이언트

```json
{
  "type": "room_list",
  "data": {
    "rooms": [
      {"id": "room1", "name": "초보자의 방", "players": 1, "status": "waiting"},
      {"id": "room2", "name": "고수방", "players": 2, "status": "playing"}
    ]
  }
}

```

```json
{
  "type": "game_state",
  "data": {
    "board": [[0,0,1,...], ...],
    "current_turn": "black",
    "black_time": 28,
    "white_time": 30
  }
}

```

```json
{
  "type": "game_over",
  "data": {
    "winner": "black",
    "reason": "five_in_row"
  }
}

```

---

## ⚙️ 설정 파일 (config.json)

```json
{
  "server": {
    "host": "0.0.0.0",
    "port": 8080
  },
  "client": {
    "server_address": "localhost",
    "server_port": 8080
  },
  "game": {
    "board_size": 15,
    "time_per_move": 30,
    "rules": "renju"
  },
  "ui": {
    "black_stone_color": "white",
    "white_stone_color": "cyan",
    "cursor_color": "yellow",
    "warning_time": 10
  },
  "logging": {
    "enabled": true,
    "log_file": "omok.log",
    "level": "INFO"
  }
}

```

---

## 🔒 에러 처리 및 로깅

### 에러 처리 원칙

1. **사용자 친화적 메시지**
    - 기술적 용어 대신 이해하기 쉬운 설명
    - 해결 방법 제시
    
    예시:
    
    - ❌ "ConnectionRefusedError: [Errno 111]"
    - ✅ "서버에 연결할 수 없습니다. 서버가 실행 중인지 확인해주세요."
2. **상세한 로깅**
    - 모든 네트워크 통신 기록
    - 게임 진행 상황 (누가, 언제, 어디에 착수)
    - 에러 발생 시 스택 트레이스
    - 로그 파일: `omok.log`

### 주요 에러 시나리오

- 서버 연결 실패
- 네트워크 끊김
- 잘못된 착수 (이미 돌이 있는 곳)
- 금수 위반 (렌주룰)
- 시간 초과
- 방이 가득 참

---

## 📦 빌드 및 배포

### 서버 실행

```bash
# Python 환경에서 직접 실행
python server.py

```

### 클라이언트 빌드 (exe)

```bash
# PyInstaller로 exe 생성
pyinstaller --onefile --console --name omok-client client.py

# 생성된 파일: dist/omok-client.exe

```

### 클라이언트 실행 방법

1. **더블 클릭**: `omok-client.exe` 더블 클릭 → 명령 프롬프트 창에서 실행
2. **CMD/PowerShell**:
    
    ```bash
    omok-client.exe
    
    ```
    

### 배포 패키지

```
omok-game-release/
├── server/
│   ├── server.py
│   ├── config.json
│   └── requirements.txt
└── client/
    ├── omok-client.exe      # Windows 실행 파일
    └── config.json

```

---

## 🎨 UI/UX 세부사항

### 색상 구성

- **흑돌**: 흰색 텍스트 (●)
- **백돌**: 청록색 텍스트 (○)
- **커서**: 노란색 하이라이트 `[·]`
- **경고**: 빨간색 (시간 10초 이하)
- **성공 메시지**: 녹색
- **에러 메시지**: 빨간색

### 화면 전환

1. **시작 화면**: 서버 접속 → 닉네임 입력
2. **로비 화면**: 방 생성 / 방 목록 보기
3. **대기실**: 상대방 입장 대기
4. **게임 화면**: 오목판 + 게임 진행
5. **결과 화면**: 승자 표시 + 로비로 돌아가기

### 메뉴 시스템

게임 중 ESC 키:

```
┌─────────────────┐
│   게임 메뉴     │
├─────────────────┤
│ 1. 계속하기     │
│ 2. 무르기 요청  │
│ 3. 기권하기     │
│ 4. 설정         │
└─────────────────┘

```

---

## 🧪 테스트 체크리스트

### 기본 기능

- [ ]  서버 시작 및 대기
- [ ]  클라이언트 서버 접속
- [ ]  닉네임 설정
- [ ]  방 생성
- [ ]  방 목록 조회
- [ ]  방 입장
- [ ]  게임 시작 (2명 입장 시)

### 게임 플레이

- [ ]  화살표 키로 커서 이동
- [ ]  Enter로 착수
- [ ]  턴 교대
- [ ]  시간 카운트다운
- [ ]  승리 조건 체크 (가로/세로/대각선)
- [ ]  렌주룰 검증 (3-3, 4-4, 6목 금지)

### 추가 기능

- [ ]  무르기 요청 및 응답
- [ ]  기권 기능
- [ ]  시간 초과 처리
- [ ]  네트워크 끊김 처리

### 빌드

- [ ]  exe 파일 생성
- [ ]  exe 더블 클릭 실행
- [ ]  CMD/PowerShell 실행
- [ ]  config.json 읽기

---

## 📚 참고 자료

### 렌주룰 상세

- **3-3 금지**: 한 수로 동시에 두 개의 열린 3목을 만드는 것 금지
- **4-4 금지**: 한 수로 동시에 두 개의 4목을 만드는 것 금지
- **6목 금지**: 6개 이상 연속은 무효 (백돌은 예외)
- **장목**: 5개를 초과하는 연속 (흑돌만 금지)

### 개발 팁

1. **프로토타입 우선**: 기본 게임 로직을 먼저 완성한 후 UI 개선
2. **단계별 테스트**: 각 기능을 추가할 때마다 테스트
3. **로그 활용**: 문제 발생 시 로그 파일 확인
4. **네트워크 딜레이**: 최소 100ms 정도의 여유 고려

---

## 🚀 구현 순서 제안

1. **1단계**: 기본 서버-클라이언트 연결
2. **2단계**: 방 시스템 (생성, 목록, 입장)
3. **3단계**: 기본 게임 로직 (15x15 판, 착수, 턴 교대)
4. **4단계**: 승리 조건 체크
5. **5단계**: 렌주룰 구현
6. **6단계**: UI 개선 (색상, 커서, 화살표 키 입력)
7. **7단계**: 시간 제한
8. **8단계**: 무르기, 기권 기능
9. **9단계**: 에러 처리 및 로깅
10. **10단계**: exe 빌드 및 테스트